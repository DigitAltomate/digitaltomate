!function(a,b,c,d){function e(){spSessionsControlL10n.hasDismissibleNotices&&a("#secupress-sessions-control-notice").each(function(){var b=a(this),c=a('<button type="button" class="notice-dismiss"><span class="screen-reader-text"></span></button>'),d=commonL10n.dismiss||"";c.find(".screen-reader-text").text(d),c.on("click.wp-dismiss-notice",function(a){a.preventDefault(),b.fadeTo(100,0,function(){b.slideUp(100,function(){b.remove()})})}),b.append(c)})}function f(b){var c,d;if(b.data.message){if(d=a("#secupress-sessions-control-notice"),d.length)return d.removeClass("updated error").addClass(b.success?"updated":"error"),d.children("p").remove(),void d.prepend("<p>"+b.data.message+"</p>");c=a(".wrap > h1").first(),d=a('<div id="secupress-sessions-control-notice" class="updated notice is-dismissible"><p></p></div>'),d.children("p").html(b.data.message),c.length||(c=a(".wrap > h2").first()),c.length?c.after(d):a(".wrap").first().prepend(d),e()}}function g(b){b.closest("tr").each(function(){var b=Number(this.id.replace(/^user-/,"")),c=b===spSessionsControlL10n.userId?spSessionsControlL10n.currentUserCellText:spSessionsControlL10n.otherUsersCellText;a(this).children(".column-secupress-sessions").html("<em>"+c+"</em>")})}function h(b,c){var d,e;return"keyup"!==b.type||secupressIsSpaceOrEnterKey(b)?(d=a(c),d.hasClass("disabled")?!1:(d.addClass("disabled").attr({"aria-disabled":!0}),b.preventDefault(),e=d.attr("href"),e?e.replace("users.php","admin-ajax.php"):!1)):!1}spSessionsControlL10n.userId=Number(spSessionsControlL10n.userId),a(b.body).on("click.secupress keyup",".secupress-destroy-sessions",function(b){var c,d=h(b,this);return d?(c=a(this),void a.getJSON(d).done(function(b){a.isPlainObject(b)&&b.data&&(b.success&&a.each(b.data.ids,function(b,c){g(a("#user-"+c))}),f(b))}).always(function(){c.removeClass("disabled").removeAttr("aria-disabled")})):!1}).find(".secupress-destroy-sessions").attr({role:"button"}).removeClass("disabled").removeAttr("aria-disabled"),a(b.body).on("click.secupress keyup",".secupress-destroy-all-sessions",function(b){var c,d=h(b,this);return d?(c=a(this),void a.getJSON(d).done(function(b){a.isPlainObject(b)&&b.data&&(b.success&&g(a("#the-list").find(".secupress-destroy-sessions")),f(b))}).always(function(){c.removeClass("disabled").removeAttr("aria-disabled")})):!1}).find(".secupress-destroy-all-sessions").attr({role:"button"}).removeClass("disabled").removeAttr("aria-disabled"),a(".bulkactions select").append('<option value="secupress-destroy-user-sessions">'+spSessionsControlL10n.destroySessionsText+"</option>"),a(".bulkactions select").first().closest("form").on("submit.secupress",function(b){var c,d=a(this),e=d.find('[type="submit"]'),h={action:"secupress-destroy-user-sessions",_wpnonce:spSessionsControlL10n.bulkNonce,users:[]},i=!1;if(!e.first().attr("disabled"))return c=d.serializeArray(),a.each(c,function(a,b){"action"!==b.name&&"action2"!==b.name||"secupress-destroy-user-sessions"!==b.value?"users[]"===b.name&&b.value&&h.users.push(Number(b.value)):i=!0}),i&&!h.users?void b.preventDefault():void(i&&(e.attr({disabled:"disabled","aria-disabled":!0}),b.preventDefault(),a.getJSON(ajaxurl,h).done(function(b){a.isPlainObject(b)&&b.data&&(b.success&&a.each(b.data.ids,function(b,c){g(a("#user-"+c))}),f(b))}).always(function(){e.removeAttr("disabled aria-disabled")})))}).find('[type="submit"]').removeAttr("disabled aria-disabled")}(jQuery,document,window);