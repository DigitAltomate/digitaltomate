jQuery(function(e){WP_Optimize_Premium=WP_Optimize_Premium()});var WP_Optimize_Premium=function(){function e(e,i,t){return i||(i={}),i.images_trash_command=e,j("images_trash_command",i,t)}function i(e){var i=C("#wp-optimize-wrap .nav-tab-wrapper .nav-tab-active").is(["#wp-optimize-nav-tab-",e].join(""));return console.log(["Checking if ",e," active. Result: ",i?"TRUE":"FALSE"].join("")),i}function t(){ue||(ue=!0,re.show(),de.hide(),r(ae.DETECT_BOTH,!1,!0))}function o(e){fe.hasOwnProperty(e)&&(fe[e].abort(),delete fe[e])}function s(i){return p(!0),i||(i=re.get_selected_images()),e("move_images_to_trash",{images:i},function(e){alert(e.message),p(!1),re.remove_selected_images(),U.data("dirty",!0)})}function n(i,t){return p(!0),i||(i=de.get_selected_images()),e("remove_trash_images",{images:i},function(e){e.error?alert(e.error):e.message&&(alert(e.message),t?t.remove():de.reload()),p(!1)})}function a(i,t){return p(!0),o(ae.DETECT_IMAGES),i||(i=de.get_selected_images()),e("restore_images_from_trash",{images:i},function(e){e.error?alert(e.error):e.message&&(alert(e.message),R.data("dirty",!0),t?t.remove():de.remove_selected_images()),p(!1)})}function _(e){ce={},me={},we={};var i={support_ajax_get_info:!0,mode:ae.DETECT_IMAGES};e&&(i.forced=!0),re.show_loader(),C(document).trigger(pe.GET_INFO_START,i),fe[i.mode]=D(C(".wpo-shade-progress-message"),"images",i).fail(function(){C(document).trigger(pe.GET_INFO_DONE,i)})}function p(e){var i=C("#optimization_checkbox_images");C.each([L,Q,C("#optimization_button_images_big"),C("#optimization_button_images_small"),i,V,B,Z,Y],function(i,t){t.prop("disabled",e)}),e?(le=i.is(":checked"),i.prop("checked",!1)):(i.prop("checked",le),re.update_view(),de.update_view())}function r(e,i,t){var o={support_ajax_get_info:!0,mode:e};i&&(o.forced=i),t&&(o.quickinfo=t),console.log("Loading information about unused images."),C(document).trigger(pe.GET_INFO_START,o),fe[e]=D(C(".wpo-shade-progress-message"),"images",o).fail(function(){C(document).trigger(pe.GET_INFO_DONE,o),J.show()}).always(function(){delete fe[e]})}function d(){var e=S(),i=ce.hasOwnProperty(e)?ce[e]:0;if(0!=i&&(!we.hasOwnProperty(e)||_e.BUSY!==we[e]&&_e.COMPLETE!==we[e])){C("#wpo_unused_images_loader_bottom").css("visibility","visible"),we[e]=_e.BUSY;var t={optimization_id:"images",data:{mode:ae.DETECT_IMAGES,blog_id:e,length:he,offset:i}};j("get_optimization_info",t,function(i){var t=g(i.result.meta);l(S()),t==he?we[e]=_e.SUCCESS:we[e]=_e.COMPLETE,C("#wpo_unused_images_loader_bottom").css("visibility","hidden"),re.update_view()}).fail(function(){we[e]=_e.FAILURE,C("#wpo_unused_images_loader_bottom").css("visibility","hidden")})}}function u(){var i=S(),t=de.get_images_count(i);if(!ge.hasOwnProperty(i)||_e.BUSY!==ge[i]&&_e.COMPLETE!==ge[i])return ge[i]=_e.BUSY,C("#wpo_unused_images_loader_bottom").css("visibility","visible"),0==t&&(C(".wpo_shade",G).show(),C(".wpo-shade-progress-message").html("")),e("get_trash_images",{offset:t,length:he,blog_id:i},function(e){if(C("#wpo_unused_images_loader_bottom").css("visibility","hidden"),C(".wpo_shade",G).hide(),e.errors)return void alert(e.errors.join("\n"));var t,o,s,n;for(t in e.images)e.images.hasOwnProperty(t)&&(o=e.images[t][0],n=e.images[t].length>1?[e.images[t][0]," [id:",e.images[t][1]," ]"].join(""):e.images[t][0],s=[e.base_url,e.images[t][0]].join(""),de.append_image(i,o,s,s,n,n));e.images&&e.images.length===he?ge[i]=_e.SUCCESS:ge[i]=_e.COMPLETE,de.update_view()})}function l(e){me.hasOwnProperty(e)&&C("#wpo_unused_images_loaded_count").text(me[e])}function c(e){return!!(e.result&&e.result.hasOwnProperty("meta")&&e.result.meta)&&e.result.meta}function m(e,i){var t=c(e);t?i&&i(t):alert(wpoptimize.error_unexpected_response)}function h(e){var i=!e.hasOwnProperty("removed_message");i&&W.text("");var t=["last_scan_",ae.DETECT_IMAGES].join("");if(C(".wpo-last-scan-text",G).text(e[t]),e&&e.hasOwnProperty("unused_images")){var o,s="",n=!1,a=ie.val();i&&g(e),ie.html("");for(o in e.unused_images)e.unused_images.hasOwnProperty(o)&&(e.images_loaded_text.hasOwnProperty(o)&&(me[o]=e.images_loaded_text[o]),e.multisite&&(n=!0,s=[e.sites[o].domain,e.sites[o].path].join(""),ie.append(['<option value="',o,'">',s,0==e.unused_images[o].length?" ("+wpoptimize.no_unused_images+")":"","</option>"].join(""))))}e&&0===e.files&&(me[S()]="",we[S()]=_e.COMPLETE),n?(ee.show(),a&&ie.val(a),f(ie.val())):ee.hide(),l(S())}function w(e){var i=["last_scan_",ae.DETECT_SIZES].join("");C(".wpo-last-scan-text",F).text(e[i]),b(C("#registered_image_sizes"),v(e.image_sizes,"used",!0),wpoptimize.no_registered_image_sizes),b(C("#unused_image_sizes"),v(e.image_sizes,"used",!1),wpoptimize.no_unsed_image_sizes),C("#registered_image_sizes, #unused_image_sizes").on("change",'input[type="checkbox"]',function(){P()}),P()}function g(e){var i,t,o=0,s="",n="",a="",_={};for(o in e.unused_images)if(e.unused_images.hasOwnProperty(o)){e.images_loaded_text.hasOwnProperty(o)&&(me[o]=e.images_loaded_text[o]),s=e[["baseurl_",o].join("")],n=e[["adminurl_",o].join("")],t=0;for(i in e.unused_images[o])e.unused_images[o].hasOwnProperty(i)&&(t++,_=e.unused_images[o][i],e.multisite&&(a=[e.sites[o].domain,e.sites[o].path].join("")),z(_,s,n,o,a));ce.hasOwnProperty(o)?ce[o]+=t:ce[o]=t}return t}function f(e){re.filter_by_site(e),de.is_visible()&&de.reload()}function v(e,i,t){var o,s=[];for(o in e)e.hasOwnProperty(o)&&e[o].hasOwnProperty(i)&&t==e[o][i]&&(s[o]=e[o]);return s}function b(e,i,t){var o,s=!0;if(e.text(""),i)for(o in i)i.hasOwnProperty(o)&&(e.append(['<label for="chk_',o,'" class="unused-image-sizes__label"><input type="checkbox" id="chk_',o,'" class="unused-image-sizes" name="',o,'">',o," (",i[o].size_formatted," - Total: ",i[o].files,")</lalbel><br>"].join("")),s=!1);s?(C(".hide_on_empty",e.parent()).hide(),e.append(["<i>",t,"</i>"].join(""))):C(".hide_on_empty",e.parent()).show()}function z(e,i,t,o,s){var n=[o,e.id?e.id:e.url].join("_"),a=e.id?[t,"post.php?post=",e.id,"&action=edit"].join(""):[i,"/",e.url].join(""),_=e.id?["#",e.id].join(""):e.url,p=[i,"/",e.url].join(""),r=[i,"/",e.id&&e.url?e.url.replace(/(\-[0-9]+x[0-9]+)(\.[a-z]+)$/i,"$2"):e.url,e.id?[" [id: ",e.id,"]"].join(""):""].join("");s&&(_=[_," [",s,"]"].join("")),re.append_image(o,n,a,p,_,r)}function y(e){re.switch_view_mode(e),de.switch_view_mode(e)}function E(){var e=[];e=0==C("#wpo_unused_images input:not(:checked)").length&&_e.COMPLETE==we[S()]?"all":re.get_selected_images(),0!=e.length&&O(e)}function O(e){return C(document).trigger(pe.OPTIMIZATION_START),j("do_optimization",{optimization_id:"images",data:{selected_images:e,images_loaded:ce}},function(i){var t,o,s,n;for(t in e)e.hasOwnProperty(t)&&(s=e[t],o=C(['#wpo_unused_images input[value="',s,'"'].join("")),n=s.split("_").shift(),ce[n]--,o.closest(".wpo_unused_image").remove());C(document).trigger(pe.OPTIMIZATION_DONE,i),re.load_next_page_if_need()}).fail(function(){alert(wpoptimize.error_unexpected_response)})}function T(){var e=[];return C('#registered_image_sizes input[type="checkbox"], #unused_image_sizes input[type="checkbox"]').each(function(){var i=C(this);i.is(":checked")&&e.push(i.prop("name"))}),e}function k(){var e=T();if(!Q.prop("disabled")&&e&&0!=e.length){var i=C("#registered_image_sizes"),t=C("#unused_image_sizes"),o=i.parent(),s=C(".wpo_unused_images_loader",o);p(!0),s.show(),j("do_optimization",{optimization_id:"images",data:{selected_sizes:e}},function(e){m(e,function(e){b(i,v(e.image_sizes,"used",!0),wpoptimize.no_registered_image_sizes),b(t,v(e.image_sizes,"used",!1),wpoptimize.no_used_image_sizes)}),p(!1),P(),s.hide(),alert(e.result.meta.removed_message)}).fail(function(){p(!1),P(),s.hide(),alert(wpoptimize.error_unexpected_response)})}}function P(){var e=C("#registered_image_sizes"),i=C("#unused_image_sizes");C('input[type="checkbox"]:checked',e).length+C('input[type="checkbox"]:checked',i).length>0?Q.prop("disabled",!1):Q.prop("disabled",!0)}function S(){return ie.length&&ie.val()?ie.val():1}function x(e){var i="";i=C("#wpo_lazy_load_settings input[type='text'], #wpo_lazy_load_settings input[type='radio']").serialize(),C.each(C("#wpo_lazy_load_settings input[type='checkbox']"),function(){var e=C(this).prop("checked")?"1":"0";i+="&"+C(this).attr("name")+"="+e}),j("save_lazy_load_settings",i,function(i){C("body").trigger("wpo_purge_cache"),e&&e(i)})}function I(e){var i=e.id,t=e.title,o=C("#wpo-popup-preview"),s=['<table id="wpo-preview-tablesorter" cellspacing="1" class="tablesorter"></table>','<h4 id="wpo-preview-message" style="display: none;"></h4>'].join(""),n=['<div id="pager" class="pager" style="display: none">','<span class="first dashicons dashicons-controls-skipback"></span>','<span class="prev dashicons dashicons-controls-back"></span>','<input type="text" class="pagedisplay">','<span class="pagedisplay-count"></span>','<span class="next dashicons dashicons-controls-forward"></span>','<span class="last dashicons dashicons-controls-skipforward"></span>','<select class="pagesize">','<option value="50">50</option>','<option value="100">100</option>','<option value="200">200</option>','<option value="300">300</option>','<option value="400">400</option>','<option value="500">500</option>',"</select>","</div>"].join(""),a="",_=[],p={};if("undefined"!=typeof wpoptimize.sites&&wpoptimize.sites.length){for(var r in wpoptimize.sites)wpoptimize.sites.hasOwnProperty(r)&&_.push(['<option value="',wpoptimize.sites[r].blog_id,'">',wpoptimize.sites[r].domain,wpoptimize.sites[r].path,"</option>"].join(""));a=['<select id="wpo-preview-site" style="display: none">',_.join(""),"</select>"].join("")}p[wpoptimize.delete_selected_items_btn]=function(){var t=[],o=C("#wpo-preview-tablesorter");if(C("input:checkbox:checked",o).each(function(){C(this).is("#wpo-select-all-preview-rows")||t.push(C(this).val())}),0!=t.length){var s=e;s.ids=t,C("#wpo-preview-site").length&&(s.site_id=C("#wpo-preview-site").val()),d.show(),wp_optimize.send_command("do_optimization",{optimization_id:i,data:s},function(e){C("#wpo-preview-tablesorter").trigger("reload"),C("#wpo-select-all-preview-rows").prop("checked",!1),j("get_optimization_info",{optimization_id:i},function(e){var t=(e&&e.result&&e.result.meta?e.result.meta:{},e&&e.result&&e.result.output?e.result.output.join("<br>"):""),o={};if(""!=t){C(["#optimization_info_",i,' input[type="checkbox"]'].join("")).each(function(){o[C(this).attr("name")]=C(this).prop("checked")}),C(["#optimization_info_",i].join("")).html(t);for(var s in o)o.hasOwnProperty(s)&&C(["#optimization_info_",i,' input[name="',s,'"]'].join("")).prop("checked",o[s])}})})}},p[wpoptimize.close_btn]=function(){C(this).dialog("destroy")},o.dialog({autoOpen:!1,title:t,minWidth:800,minHeight:400,modal:!0,close:function(){C(this).dialog("destroy"),C("#wpo-popup-preview").html("")},buttons:p}),C("#wpo-preview-tablesorter").hide(),o.html(s),C(".ui-dialog-buttonpane button").first().hide(),C(".ui-dialog-buttonpane").prepend([n,a].join("")),C(".ui-dialog-title").append(['<i id="wpo-preview-loader"><img width="12" height="12" src="',wpoptimize.spinner_src,'" /></i>'].join(""));var d=C("#wpo-preview-loader > img"),u=C("#wpo-preview-site"),l=new TableSorter_DataSource({optimization_id:i,limit:1});for(var r in e)e.hasOwnProperty(r)&&"id"!=r&&"title"!=r&&l.set_option(r,e[r]);u.length&&u.val()&&l.set_option("site_id",u.val()),u.on("change",function(){l.set_option("site_id",u.val()),C("#wpo-preview-tablesorter").trigger("reload")}),l.fetch().done(function(e){var i=C("#wpo-preview-tablesorter");try{e=wpo_parse_json(e)}catch(t){return void alert(wpoptimize.error_unexpected_response)}i.hide();var o,s=[],n=[],a=1,_={0:{sorter:!1}};s.push('<th style="width: 20px"><input id="wpo-select-all-preview-rows" type="checkbox" /></th>'),n.push("<th></th>");for(o in e.result.columns)e.result.columns.hasOwnProperty(o)&&(_[a]={sorter:!1},a++,s.push(['<th class="header">',e.result.columns[o],"</th>"].join("")),n.push(["<th>",e.result.columns[o],"</th>"].join("")));i.append(["<thead><tr>",s,"</tr></thead>"].join("")),i.append(["<tfoot><tr>",n,"</tr></tfoot>"].join("")),i.append("<tbody></tbody>");var p=C("#pager");i.tablesorter({widthFixed:!0,widgets:["zebra"],headers:_}).tablesorterPager({container:p,size:parseInt(C(".pagesize",p).val()),dataSource:l}),i.on("load_start",function(){d.show()}),i.on("load_end",function(e,i){d.hide(),parseInt(i.result.total)>0?(C("#wpo-preview-tablesorter").show(),C("#wpo-preview-message").hide(),C(".ui-dialog-buttonpane #pager").show(),C(".ui-dialog-buttonpane button").first().show()):(C("#wpo-preview-tablesorter").hide(),C("#wpo-preview-message").text(i.result.message).show(),C(".ui-dialog-buttonpane #pager").hide(),C(".ui-dialog-buttonpane button").first().hide()),C("#wpo-preview-site").show()})}),o.dialog("open")}var C=jQuery,j=WP_Optimize.send_command,D=WP_Optimize.optimization_get_info,A=WP_Optimize.take_a_backup_with_updraftplus,M=WP_Optimize.save_auto_backup_options;console.log("Loading WP-O Premium");var N=C("#wp-optimize-nav-tab-wpo_images-unused-contents"),G=C("#wpo-unused-images-section"),F=C("#wpo-unused-image-sizes-section"),W=C("#wpo_unused_images"),H=C("#wpo_unused_images_trash"),R=C("#wpo_unused_images_view_images_btn"),U=C("#wpo_unused_images_view_trash_btn"),Z=C("#wpo_restore_unused_images_from_trash_btn"),L=C("#wpo_remove_unused_images_btn"),B=C("#wpo_move_unused_images_to_trash_btn"),Y=C("#wpo_remove_unused_images_from_trash_btn"),Q=C("#wpo_remove_selected_sizes_btn"),V=C("#wpo_unused_images_refresh"),X=C("#wpo_unused_image_sizes_refresh"),$=C("#wpo_unused_images_select_all"),q=C("#wpo_unused_images_select_none"),J=C("#wpo_scan_for_unused_images"),K=C("#wpo_scan_for_unused_image_sizes"),ee=C("#wpo_unused_images_sites_select_container"),ie=C("#wpo_unused_images_sites_select"),te=C("#enable-auto-backup-2"),oe=C("#enable-auto-backup-3"),se=wpoptimize.sites.length>1?[C("#wpo_unused_images_loaded_count")]:[C("#wpo_unused_images_control_panel"),C("#wpo_unused_images_loaded_count")],ne=wpoptimize.sites.length>1?[]:[C("#wpo_unused_images_control_panel")],ae={DETECT_IMAGES:"detect_unused_images",DETECT_SIZES:"detect_images_sizes",DETECT_BOTH:"detect_both"},_e={COMPLETE:"complete",SUCCESS:"success",FAILURE:"failure",BUSY:"busy"},pe={GET_INFO_START:"optimization_get_info_images_start",GET_INFO_PROCESS:"optimization_get_info_images",GET_INFO_PROCESS_XHR_UPDATE:"optimization_get_info_xhr_images",GET_INFO_DONE:"optimization_get_info_images_done",OPTIMIZATION_START:"do_optimization_images_start",OPTIMIZATION_DONE:"do_optimization_images_done"},re=new WP_Optimize_Images_View({container:W,no_images_found_message:wpoptimize.no_unused_images_found,related_elements:[C(".wpo-last-scan-info",G),C(".wpo-unused-images-el"),C(".wpo-image-sizes-section"),C("#wpo_unused_images_loaded_count"),C("#wpo_unused_images_refresh")],row_action_buttons:[{"class":"wpo_unused_images_move_to_trash_single button button-primary",title:wpoptimize.trash,hint:wpoptimize.move_to_trash},{"class":"wpo_unused_images_remove_single button button-link button-link-delete",title:wpoptimize["delete"],hint:wpoptimize.permanently_delete}],action_buttons:[L,B],hide_when_empty:se,loader_additional_html:'<a class="wpo-unused-images-cancel-scan" data-mode="'+ae.DETECT_IMAGES+'">'+wpoptimize.cancel_scan+"</a>",load_next_page_callback:d}),de=new WP_Optimize_Images_View({container:H,no_images_found_message:wpoptimize.no_unused_trash_images_found,related_elements:[C(".wpo-unused-images-trash-el")],row_action_buttons:[{"class":"wpo_unused_images_restore_from_trash_single button",title:wpoptimize.restore,hint:wpoptimize.restore_from_trash},{"class":"wpo_unused_images_remove_single_from_trash button button-primary",title:wpoptimize["delete"],hint:wpoptimize.permanently_delete}],action_buttons:[Z,Y],hide_when_empty:ne,load_next_page_callback:u,onclear:function(){ge[S()]=""}}),ue=!1,le=!1,ce={},me={},he=wpoptimize.unused_images_per_page,we={},ge={},fe={};J.on("click",function(){r(ae.DETECT_IMAGES,!0)}),K.on("click",function(){r(ae.DETECT_SIZES,!0)}),N.on("click",".wpo-unused-images-cancel-scan",function(){var e=C(this),i=e.data("mode"),t={mode:i,cancel:!0},s={optimization_id:"images",data:t};e.prop("disabled")||(e.prop("disabled",!0),o(i),j("get_optimization_info",s,function(e){C(document).trigger(pe.GET_INFO_DONE,s)}).always(function(){e.prop("disabled",!1)}))}),U.on("click",function(){return U.hide(),R.show(),U.data("dirty")&&(U.data("dirty",!1),de.clear()),re.hide(),de.show(),N.addClass("wpo-unused-images-trash-view"),!1}),R.on("click",function(){return R.hide(),U.show(),de.hide(),re.show(),N.removeClass("wpo-unused-images-trash-view"),R.data("dirty")&&(R.data("dirty",!1),_(!1)),!1}),C(document).on(pe.GET_INFO_START,function(e,i){var t=i&&i.hasOwnProperty("mode")?i.mode:"";V.prop("disabled",!0),t==ae.DETECT_IMAGES&&(C(".wpo_shade",G).show(),C(".wpo-shade-progress-message",G).text("")),t==ae.DETECT_SIZES&&(C(".wpo_shade",F).show(),C(".wpo_unused_images_loader",F).show(),C(".wpo-shade-progress-message",F).text("")),p(!0)}),C(document).on(pe.GET_INFO_PROCESS,function(e,i,t){var o=t&&t.hasOwnProperty("mode")?t.mode:"";o==ae.DETECT_IMAGES&&(C(".wpo-shade-progress-message",G).text(i),re.loader_message(i)),o==ae.DETECT_IMAGES&&C(".wpo-shade-progress-message",F).text(i)}),C(document).on(pe.GET_INFO_PROCESS_XHR_UPDATE,function(e,i,t){t.hasOwnProperty("mode")&&(fe[t.mode]=i)}),C(document).on(pe.GET_INFO_DONE,function(e,i){C("#wpo_unused_images_shade").remove(),C(".wpo_unused_images_loader").hide(),V.prop("disabled",!1),console.log(i);var t=c(i),o=t&&t.hasOwnProperty("mode")?t.mode:!!(i&&i.hasOwnProperty("data")&&i.data.hasOwnProperty("mode"))&&i.data.mode,s=i&&i.hasOwnProperty("data")&&i.data.hasOwnProperty("cancel")||o&&fe.hasOwnProperty(o)&&fe[o].hasOwnProperty("statusText")&&"abort"==fe[o].statusText;if(ae.DETECT_IMAGES==o&&(C(".wpo_shade",G).hide(),re.hide_loader(),s||(C(".wpo-unused-images-section-unloaded").hide(),C(".wpo-unused-images-section-loaded").removeClass("wpo_hidden"),m(i,h))),ae.DETECT_SIZES==o&&(C(".wpo_shade",F).hide(),s||(C(".wpo-unused-image-sizes-section-unloaded").hide(),C(".wpo-unused-image-sizes-section-loaded").removeClass("wpo_hidden"),m(i,w))),ae.DETECT_BOTH==o){var n=["last_scan_",ae.DETECT_IMAGES].join(""),a=["last_scan_",ae.DETECT_SIZES].join("");t&&t[n]&&(C(".wpo-unused-images-section-unloaded").hide(),C(".wpo-unused-images-section-loaded").removeClass("wpo_hidden"),C(".wpo_shade",G).hide(),m(i,h)),t&&t[a]&&(C(".wpo-unused-image-sizes-section-unloaded").hide(),C(".wpo-unused-image-sizes-section-loaded").removeClass("wpo_hidden"),C(".wpo_shade",F).hide(),m(i,w))}p(!1)}),C(document).on(pe.OPTIMIZATION_START,function(){ue=!0,C(".wpo_unused_images_loader").show(),p(!0)}),C(document).on(pe.OPTIMIZATION_DONE,function(e,i){C(".wpo_unused_images_loader").hide(),p(!1),m(i,h),alert(i.result.meta.removed_message)}),L.on("click",function(){0!=C('#wpo_unused_images input[type="checkbox"]:checked').length&&(M(),te.is(":checked")?A(E,"uploads"):E())}),B.on("click",function(){0!=C('#wpo_unused_images input[type="checkbox"]:checked').length&&(M(),te.is(":checked")?A(s,"uploads"):s())}),Y.on("click",function(){0!=de.get_selected_images().length&&(M(),te.is(":checked")?A(n,"uploads"):n())}),Z.on("click",function(){0!=de.get_selected_images().length&&(M(),te.is(":checked")?A(a,"uploads"):a())}),Q.on("click",function(){M(),oe.is(":checked")?A(k):k()}),V.on("click",function(e){e.preventDefault(),C(this).prop("disabled")||_(!0)}),X.on("click",function(e){if(e.preventDefault(),!C(this).prop("disabled")){var i={support_ajax_get_info:!0,forced:!0,mode:ae.DETECT_SIZES};C(".wpo_unused_images_loader",F).show(),C(document).trigger(pe.GET_INFO_START,i),D(C(".wpo-shade-progress-message"),"images",i).fail(function(){C(document).trigger(pe.GET_INFO_DONE,i)})}}),$.on("click",function(){re.is_visible()&&re.select_all(),de.is_visible()&&de.select_all()}),q.on("click",function(){re.is_visible()&&re.select_none(),de.is_visible()&&de.select_none()}),C("#wp-optimize-nav-tab-wrapper__wpo_images .nav-tab").on("click",function(){i("wpo_images-unused")&&t()}),i("wpo_images-unused")&&t(),ie.on("change",function(){var e=S();f(e),l(e)}),C(".wpo_unused_images_switch_view a").on("click",function(){y(C(this).data("mode"))}),W.on("click",".wpo_unused_images_remove_single",function(){var e=C(this),i=e.closest(".wpo_unused_image"),t=C('input[type="checkbox"]',i).attr("value");C("button",i).prop("disabled",!0),O([t]).done(function(){i.remove()})}),W.on("click",".wpo_unused_images_move_to_trash_single",function(){var e=C(this),i=e.closest(".wpo_unused_image"),t=C('input[type="checkbox"]',i).attr("value");C("button",i).prop("disabled",!0),s([t]).done(function(){i.remove()})}),H.on("click",".wpo_unused_images_restore_from_trash_single",function(){var e=C(this),i=e.closest(".wpo_unused_image"),t=C('input[type="checkbox"]',i).attr("value");C("button",i).prop("disabled",!0),a([t],i).done(function(){i.remove()})}),H.on("click",".wpo_unused_images_remove_single_from_trash",function(){var e=C(this),i=e.closest(".wpo_unused_image"),t=C('input[type="checkbox"]',i).attr("value");C("button",i).prop("disabled",!0),n([t],i).done(function(){i.remove()})}),C("#wpo_lazy_load_settings").on("click",".wp-optimize-settings-save",function(){var e=C(this),i=e.next(".wpo_spinner"),t=i.next(".dashicons-yes");i.show(),x(function(){i.hide(),t.removeClass("display-none").show().delay(5e3).fadeOut("fast",function(){t.addClass("display-none")})})}),C("body").append('<div id="wpo-popup-preview"></div>'),C("#wp-optimize-nav-tab-WP-Optimize-optimize-contents").on("click",".wpo-optimization-preview",function(){return I(C(this).data()),!1}),C("#wpo-popup-preview").on("change","#wpo-select-all-preview-rows",function(){var e=C(this).closest("table"),i=C(this).prop("checked");C("input:checkbox",e).each(function(){C(this).is("#wpo-select-all-preview-rows")||C(this).prop("checked",i)})}),C("#remove_all_transients").on("change",function(){var e=C(this).closest("td"),i=C(this).is(":checked");C("a",e).each(function(){C(this).data("remove_all_transients",i)})})};jQuery(function(e){function i(e,i){var t="";switch(e){case"wpo_once":t=WP_Optimize_Handlebars.once.handlebars({details:i});break;case"wpo_daily":t=WP_Optimize_Handlebars.daily.handlebars({details:i});break;case"wpo_weekly":t=WP_Optimize_Handlebars.weekly.handlebars({details:i});break;case"wpo_fortnightly":t=WP_Optimize_Handlebars.fortnightly.handlebars({details:i});break;case"wpo_monthly":t=WP_Optimize_Handlebars.monthly.handlebars({details:i})}return t}function t(){0===e(".wpo_scheduled_event:visible").length?(e(".wpo_auto_event_heading_container").hide(),e(".wpo_no_schedules").show()):(e(".wpo_auto_event_heading_container").show(),e(".wpo_no_schedules").hide()),0!==e(".wpo_scheduled_event:visible").length||0!==e(".wpo_auto_event:visible").length||e("#save_settings_reminder").is(":visible")?e(".wpo_no_schedules").hide():e(".wpo_no_schedules").show()}var o=e("#wp-optimize-auto-options"),s=e('input[type="time"]'),n=e('input[type="date"]'),a=(new Date).toISOString().split("T")[0],_=e(".wpo_auto_event:last").data("count")||0;s.each(function(i,t){Modernizr.inputtypes.time||(e(t).timepicker({timeFormat:"H:i"}),e(t).addClass("no_date_time_support"),e(t).on("changeTime",function(){e(this).timepicker("hide")}))}),o.on("focus",'input[type="time"]',function(){var i=e(this).get(0);Modernizr.inputtypes.time||(e(i).timepicker({timeFormat:"H:i"}),e(i).on("changeTime",function(){e(this).timepicker("hide")}))}),o.on("keypress","input",function(e){if(13===e.keyCode)return!1}),n.each(function(i,t){Modernizr.inputtypes.date||(e(t).datepicker({dateFormat:"yy-mm-dd",minDate:0}),e(t).addClass("no_date_time_support"))}),o.on("focus",'input[type="date"]',function(){var i=e(this).get(0);Modernizr.inputtypes.date||e(i).datepicker({dateFormat:"yy-mm-dd",minDate:0})}),0!==e(".wpo_scheduled_event").length?e(".wpo_no_schedules").hide():e(".wpo_no_schedules").show(),e(".wpo_auto_optimizations").select2({placeholder:wpoptimize.select_optimizations}),e(".wpo_auto_optimizations").on("select2:opening select2:closing",function(i){var t=e(this).parent().find(".select2-search__field");t.prop("disabled",!0)}),e("#purge_cache_permissions").select2({placeholder:wpoptimize.select_roles}),o.on("change",'select, input[type="date"], input[type="time"]',function(){e("#save_settings_reminder").slideDown(),t()}),e("#wpo-add-event").on("click",function(i){i.preventDefault(),_++;var t=WP_Optimize_Handlebars.optimizations.handlebars({optimizations:wpoptimize.auto_optimizations,count:_}),o=WP_Optimize_Handlebars.schedule_types.handlebars({schedule_types:wpoptimize.schedule_types,count:_}),s=WP_Optimize_Handlebars.action.handlebars({count:_}),n='<div class="wpo_auto_event wpo_cf" data-count="'+_+'">';n+=t+o+s,n+="</div>",e("#wpo_auto_events").prepend(n),e(".wpo_auto_optimizations").select2({placeholder:wpoptimize.select_optimizations}),e(".wpo_auto_optimizations").on("select2:opening select2:closing",function(i){var t=e(this).parent().find(".select2-search__field");t.prop("disabled",!0)})}),o.on("change",".wpo_schedule_type",function(){var t=e(this).closest(".wpo_auto_event"),o=t.data("count")||_,s=e(this).val(),n="";Modernizr.inputtypes.date&&Modernizr.inputtypes.time||(n="no_date_time_support");var p={date:wpoptimize.date,time:wpoptimize.time,day:wpoptimize.day,day_number:wpoptimize.day_number,days:wpoptimize.days,date_value:"",time_value:"00:00",status:wpoptimize.active,status_value:"checked",week_days:wpoptimize.week_days,week:wpoptimize.week,count:o,class_name:n,today:a},r=i(s,p),d=WP_Optimize_Handlebars.status.handlebars({details:p}),u=WP_Optimize_Handlebars.action.handlebars({});e(this).next().html(""),t.find(".wpo_event_status").remove(),t.find(".wpo_event_actions").remove(),""!==r&&e(this).next().html(r),t.append(d+u)}),o.on("click",".wpo_edit_event",function(){var i=e(this).closest(".wpo_scheduled_event");i.hide(),i.next().show(),t()}),o.on("click",".wpo_remove_event",function(){var i=e(this).data("count"),o=confirm(wpoptimize.confirm_remove_task);if(!0===o){var s=e(this).closest(".wpo_scheduled_event"),n=e(this).closest(".wpo_auto_event");i==s.next().data("count")&&(s.next().remove(),s.remove()),i==n.prev().data("count")&&n.prev().remove(),n.remove(),e("#save_settings_reminder").slideDown(),t()}}),e("#database_settings_form").on("wpo-saving-form-data",function(i){var o=!0,s=e("#database_settings_form");s.find(".wpo_auto_optimizations").each(function(){e(this).val()||(o=!1)}),s.find(".wpo_schedule_type").each(function(){e(this).val()||(o=!1)}),!1===o?(s.form_errors.add("missing-fields",""),i.stopImmediatePropagation(),s.find(".wp-optimize-settings-save-results").show().addClass("wpo_alert_notice").text(wpoptimize.fill_all_fields).delay(5e3).fadeOut(3e3,function(){e(this).removeClass("wpo_alert_notice")})):s.form_errors.remove("missing-fields"),e("#save_settings_reminder").slideUp("normal",function(){t()})})});